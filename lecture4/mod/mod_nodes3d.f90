MODULE mod_nodes3d
!####################################################################

IMPLICIT NONE

!--------------------------------------------------------------------

TYPE :: struct_nodes3d

!--------------------------------------------------------

PRIVATE

!--------------------------------------------------------
!
! n
! The total number of nodes
!
!--------------------------------------------------------
!
! x(:, :)
! Cartesian coordinates of a node
! (x, y, z)
!
!--------------------------------------------------------
!
! u(:)
! Unknown
!
! bc(:)
! Boundary condition of unknown
!
!--------------------------------------------------------

INTEGER :: n
INTEGER, ALLOCATABLE :: bc(:)

REAL(8), ALLOCATABLE :: x(:, :)
REAL(8), ALLOCATABLE :: u(:)

!--------------------------------------------------------

END TYPE struct_nodes3d

!--------------------------------------------------------------------

CONTAINS

! Set the total number of nodes
!####################################################################
SUBROUTINE set_nodes3d_n(ns3d, n)
!####################################################################

  TYPE(struct_nodes3d), INTENT(INOUT) :: ns3d

  INTEGER, INTENT(IN) :: n

!--------------------------------------------------------------------

  ns3d%n = n

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE set_nodes3d_n
!####################################################################

! Get the total number of nodes
!####################################################################
SUBROUTINE get_nodes3d_n(ns3d, n)
!####################################################################

  TYPE(struct_nodes3d), INTENT(IN) :: ns3d

  INTEGER, INTENT(OUT) :: n

!--------------------------------------------------------------------

  n = ns3d%n

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE get_nodes3d_n
!####################################################################

! Set Cartesian coordinates of a node

!####################################################################
SUBROUTINE set_nodes3d_x(ns3d, x)
!####################################################################

  TYPE(struct_nodes3d), INTENT(INOUT) :: ns3d

  REAL(8), INTENT(IN) :: x(:, :)

!--------------------------------------------------------------------

  ns3d%x = x

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE set_nodes3d_x
!####################################################################


! Get Cartesian coordinates of a node
!####################################################################
SUBROUTINE get_nodes3d_x(ns3d, x)
!####################################################################

  TYPE(struct_nodes3d), INTENT(IN) :: ns3d

  REAL(8), INTENT(OUT) :: x(:, :)

!--------------------------------------------------------------------

  INTEGER :: i
  INTEGER :: id

!--------------------------------------------------------------------

  x = ns3d%x

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE get_nodes3d_x
!####################################################################

! Set unknown
!####################################################################
SUBROUTINE set_nodes3d_u(ns3d, u)
!####################################################################

  TYPE(struct_nodes3d), INTENT(INOUT) :: ns3d

  REAL(8), INTENT(IN) :: u(:)

!--------------------------------------------------------------------

  ns3d%u = u

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE set_nodes3d_u
!####################################################################

! Get unknown
!####################################################################

SUBROUTINE get_nodes3d_u(ns3d, u)
!####################################################################
  TYPE(struct_nodes3d), INTENT(IN) :: ns3d

  REAL(8), INTENT(OUT) :: u(:)

!--------------------------------------------------------------------

  u = ns3d%u

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE get_nodes3d_u
!####################################################################

! Set boundary condition of unknown
!####################################################################
SUBROUTINE set_nodes3d_bc(ns3d, bc)
!####################################################################

  CLASS(struct_nodes3d), INTENT(INOUT) :: ns3d

  INTEGER, INTENT(IN) :: bc(:)

!--------------------------------------------------------------------

  ns3d%bc = bc

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE set_nodes3d_bc
!####################################################################

! Get boundary condition of unknown
!####################################################################
SUBROUTINE get_nodes3d_bc(ns3d, bc)
!####################################################################

CLASS(struct_nodes3d), INTENT(IN) :: ns3d

INTEGER, INTENT(OUT) :: bc(:)

!--------------------------------------------------------------------

bc = ns3d%bc

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE get_nodes3d_bc
!####################################################################

! Initialize nodes3d
!####################################################################
SUBROUTINE init_nodes3d(ns3d, n)
!####################################################################

  TYPE(struct_nodes3d), INTENT(INOUT) :: ns3d

  INTEGER, INTENT(IN) :: n

!--------------------------------------------------------------------

  ns3d%n = n

!--------------------------------------------------------------

  ALLOCATE( ns3d%x(3, n) )

  ns3d%x = 0.0D0

!--------------------------------------------------------------

  ALLOCATE( ns3d%u(3*n) )
  ALLOCATE( ns3d%bc(3*n) )

  ns3d%u = 0.0D0
  ns3d%bc = 0

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE init_nodes3d
!####################################################################

! Delete nodes3d
!####################################################################
SUBROUTINE del_nodes3d(ns3d)
!####################################################################

  TYPE(struct_nodes3d), INTENT(INOUT) :: ns3d

!--------------------------------------------------------------------

!--------------------------------------------------------------------

  ns3d%n = 0

!--------------------------------------------------------------

  DEALLOCATE( ns3d%x )

!--------------------------------------------------------------

  DEALLOCATE( ns3d%u )
  DEALLOCATE( ns3d%bc )

!--------------------------------------------------------------------

  RETURN

!####################################################################
END SUBROUTINE del_nodes3d
!####################################################################

!####################################################################
END MODULE mod_nodes3d
